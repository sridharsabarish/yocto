# Exercise : IMAGES

## Learning Outcome
* Learn how to build an image with specific constraints
	* Choose the Image Filesystem
	* Choose the rootfs size
	* Add specific packages and remove some packages from the image.
	* Update your image recipe to include a buildtag


## What is an image?

* A Yocto image is a **custom Linux system** built for embedded devices, created using the Yocto Project.
* It combines the **Linux kernel, essential software, and settings** into one ready-to-use package.
* You can tailor the image to include only the software and features you need, making it lightweight and efficient for specific hardware.
* The Yocto build system makes it easy to select what goes into the image, ensuring it’s optimized for performance.
* Once built, the image can be installed on devices, offering a stable and flexible solution for embedded projects.

  

## Part 0 : Getting Started Studying an image.

If you recollect, when we worked with `source oe-init-build-env`, the text displayed certain images that we could "bake" which looked like "core-image-*".

1. An image looks like a recip,  Which one of these images do you not see when you source oe-init-build-env?
    1. core-image-weston
    2. core-image-full-cmdline
    3. core-image-x12
    4. core-image-sato

   <details>
   <summary>Answer</summary>
   core-image-x12 doesn't exists
   </details>


  
  
  

## Part 1 : Creating an Image Recipe
# Refer to second.bb
1. Create an image using core-image-minimal as base
3. Choose IMAGE_FSTYPE="ext4 ext3"
4. Set the rootfs size
5. Set the rootfs extraspace
6. Set the IMAGE_LINGUAS #Todo 
	1. Make a task that would set the locale to german.
7. IMAGE has several attributes that we can use to shape our image, can you find the attribute that is used to change the filesystem type?

  

    <details>

        <summary>hint</summary>

        IMAGE_FS_TYPE

    </details>

// Researrch what command is needed. FIll in hint and test. #todo 

1. Can you use this variable to change the filesystem to .ubi and .tar.gz
1. We have a requirement to change the size of the filesystem to 2GB maximum, this can be done with another variable, can you set that?
## Part 2  -  Add our recipe to the image #minoreview 
* [ ] Add openssh to the image to enable ssh.
* [ ] This image should contain the recipe that we made.

  
## Part 3 : Package Groups #minoreview 
[[package Group]]

- Package group as the name suggest, help to group packages together so that we can add them easily to our images/recipes as needed.
2. Create a directory called package group
3. Add dependency to certain packages.
4. Add the packag groupe to recipe using IMAGE_INSTALL +="";#

### Creating Package Groups
 1. A package group has already been created in the `/home/yocto/work/poky/poky/meta-exercise/recipes-packaging/packagegroups` folder. Here you need to go through the comments and add the missing packages to it. Remember the line breaks.
2. Remove the de

1. Create a `.bb` file with the name `packagegroup-meta-package.bb`





## Part 3  : Run on QEMU #unclear

1. What happens when you try to run qemu with your image name?
2. Can you find out how to run a specific image with QEMU?
3. How would other parameters affect 



* Something about settings for QEMU.
* Make them go through qemu help and set certain attributes.
* Try to run this image in

with 1024 Mb of ram

`runqemu qemuarm64 -m 1024`

  
## QEMU arguments #majorreview #todo 
```sh
runqemu qemux86-64             # Run the qemux86-64 image (default)
runqemu qemux86-64 RAM=2048    # Run with 2048 MB of RAM
runqemu qemux86-64 nographic   # Run with serial console, no graphical interface

runqemu qemux86-64 kernel=/path/to/kernel  # Use a custom kernel for boot

runqemu qemux86-64 sshd=1      # Enable SSH in the virtual machine

runqemu qemux86-64 SMP=4       # Allocate 4 CPU cores for the VM

runqemu qemux86-64 disk-image.ext4  # Use the specified disk image

runqemu qemux86-64 vnc=1       # Enable VNC on display :1 for remote access

runqemu qemux86-64 boot=d      # Boot from the disk

runqemu qemux86-64 ip=dhcp     # Set networking to use DHCP for IP address

runqemu qemux86-64 nographic bootargs="console=ttyS0 root=/dev/sda1"  # Custom boot arguments with serial console

```