 # Exercise : Create a layer

## Learning Outcome
* Learn how layers work in Yocto [[8.Layers & Recollection#Part 1 Identifying Layers]]
* Learn how to create a new layer in Yocto [[8.Layers & Recollection#Part 2 Create a new layers]]
* Learn how to include several recipes to this layer[[8.Layers & Recollection#Part 3 Adding a recipe to the Layer]].
* Learn how the layer.conf file works.
* Build?

### The tool
`bitbake-layers` is a powerful comand, it can do almost everything we want with layers.
  

## Part 1: Identifying Layers

1. Identify what layers we have in the current poky build!
    - ` bitbake-layers show-layers`
1. There is a file which keeps track of these layers, do you which one it it is?
    <details>
    <summary>hint</summary>
    `bblayers.conf`
    </details>
1. Explore The `bitabake-layers` command and find which command helps us make a new layer.
<details>
<summary>hint</summary>
Its help documentation gives us an hint
</details>
## Part 2 : Create a new layers

1. Go a step out of build folder and try to create a new layer called `meta-experiment`
1. Now to try the bitbake-layers show-layers command
1. You will notice that this layer has not been added. This has to be added manually by bitbake-layers add-layers command.
## Part 3: Adding a recipe to the Layer


### Recipe 1
1. Create a simple recipe called `solna-yocto.bb`
2. Add this info the recipe #todo 

3. Use this c code to create a file 'hello.c'
```C

    //Simple Hello World Program

    #include<stdio.h>

    int main() {

    printf("Hello World , Created Bitbake recipe successfully\n");

    return 0;

    }
```
4. The file should be added to the recipe.
1. Add the information below to the recipe

```bash


    S = "${WORKDIR}/sources"
 
    do_compile() {
			bbnote "Compiling the c file"
            ${CC} solna.c ${LDFLAGS} -o solna

    }

  

    do_install() {

			bbnote "installing this file"
            install -d ${D}${bindir}
            install -m 0755 solna ${D}${bindir}

    }
```

  

1. Select Machine configuration and hello to rootfs

  

IMAGE_INSTALL_append = " hello" #double check

  
  

<details>

  

<summary>hint</summary>

  

`bitbake-layers create-layer ../meta-experiments`

  

</details>

  

### Recipe 2
1. Create a simple recipe called `funwithflags.bb`
2. Add this info the recipe #todo 

3. Use this c code to create a file 'flags.c'

```C

    //Simple Hello World Program

    #include<stdio.h>

    int main() {

    printf("Passion for Flags is called _");

    return 0;

    }
```
4. The file should be added to the recipe.
1. Add the information below to the recipe

```bash
    S = "${WORKDIR}/sources"
 
    do_compile() {
			bbnote "Compiling the flags file"
            ${CC} flag.c ${LDFLAGS} -o flags

    }


    do_install() {

			bbnote "installing this file"
            install -d ${D}${bindisr}
            install -m 0755 flags ${D}${bindir}

    }
```


  



### Recipe 3
1. Create a simple recipe called `solna-yocto.bb`
2. Add this info the recipe #todo 

3. Use this c code to create a file 'hello.c'
```C

    //Simple Hello World Program

    #include<stdio.h>

    int main() {

    printf("Hello World , Created Bitbake recipe successfully\n");

    return 0;

    }
```
4. The file should be added to the recipe.
1. Add the information below to the recipe

```bash


    S = "${WORKDIR}/sources"
 
    do_compile() {
			bbnote "Compiling the c file"
            ${CC} solna.c ${LDFLAGS} -o solna

    }

  

    do_install() {

			bbnote "installing this file"
            install -d ${D}${bindir}
            install -m 0755 solna ${D}${bindir}

    }
```

  

1. Select Machine configuration and hello to rootfs

  

IMAGE_INSTALL_append = " hello" #double check

  
  

<details>

  

<summary>hint</summary>

  

`bitbake-layers create-layer ../meta-experiments`

  

</details>

  

### Recipe 4
1. Create a simple recipe called `funwithflags.bb`
2. Add this info the recipe #todo 

3. Use this c code to create a file 'flags.c'

```C

    //Simple Hello World Program

    #include<stdio.h>

    int main() {

    printf("Passion for Flags is called _");

    return 0;

    }
```
4. The file should be added to the recipe.
1. Add the information below to the recipe

```bash
    S = "${WORKDIR}/sources"
 
    do_compile() {
			bbnote "Compiling the flags file"
            ${CC} flag.c ${LDFLAGS} -o flags

    }


    do_install() {

			bbnote "installing this file"
            install -d ${D}${bindisr}
            install -m 0755 flags ${D}${bindir}

    }
```


  

